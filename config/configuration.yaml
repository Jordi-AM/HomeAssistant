homeassistant:
  packages: !include_dir_named packages
  customize: !include customize.yaml

default_config:

http:
  base_url: !secret duckdns
  ssl_certificate: /ssl/fullchain.pem
  ssl_key: /ssl/privkey.pem


# Text to speech
#    cache: true
#    cache_dir: /tmp/tts
#    service_name: google_say

tts:
  - platform: google_translate
    service_name: google_say # como llamaremos al servicio desde las funciones. Así, aunque HA cambie el nombre del servicio, podremos seguir usando este
                             # por defecto es google_translate_say
    language: 'es'
    # base_url: https://agui.duckdns.org
    cache: true
    #cache_dir:  # si lo dejamos en blanco, los mp3 irán a /config/tts. Así los tenemos controlados
    time_memory: 300

rest_command:
  google_backup:
    url: 'http://localhost:8055/gbdoBackup'
    timeout: '300'   

telegram_bot:
  - platform: polling
    api_key: !secret telegram_api_key
    allowed_chat_ids:
      - 440192507


xiaomi_aqara:
  discovery_retry: 10
  gateways:
    - key: !secret xiaomi_key
      mac: !secret xiaomi_mac
      host: 192.168.1.11      

vacuum:
  - platform: xiaomi_miio
    host: 192.168.1.101
    token: !secret vacuum_token
    name: Aspirino


wake_on_lan:

# https://www.home-assistant.io/integrations/webostv/
webostv:
  - host: 192.168.1.203
    name: LG
    turn_on_action:
      service: wake_on_lan.send_magic_packet
      data:
        # mac: "2c:2b:f9:70:3b:64"   wifi
        "mac": "A8:23:FE:C1:6A:CE"  # cable
    customize:
      sources:
        - livetv
        - youtube
        - netflix

notify:
  - name: correo_jam
    platform: smtp
    server: smtp.gmail.com
    port: 587
    timeout: 15
    sender: !secret user_gmail
    encryption: starttls
    username: !secret user_gmail
    password: !secret pwd_gmail
    recipient: !include direcciones.yaml
    sender_name: Notificación Home Assistant
    #debug: True

# ----------------------- Establece qué grabamos y qué no --------------------
# https://www.home-assistant.io/components/recorder/
# https://community.home-assistant.io/t/rpi-hassio-synology-nas-maria-db-for-logging/64012

recorder:
  db_url: mysql://jordiam:5SCwf9kTyezdGqp@192.168.1.9:3307/ha_2020?charset=utf8
  purge_keep_days: 21   # días a mantener después del purge
  purge_interval: 1
  exclude:
    event_types:
      - call_service
      - hacs/repository
  include:
    domains:
      - sensor

# https://www.home-assistant.io/integrations/history/
# history: en principio no ponemos nada, entonces lo hará de los mismo elementos del recorder

#********************************************************************************************************************
#
#                                                  L U C E S 
#
#********************************************************************************************************************

hue:
  bridges:
    - host: 192.168.1.23
      allow_unreachable: true
      allow_hue_groups: true


light:

# Xiaomi Philips light
# de momento la desactivo, porque siempre está apagada, y entonces da errores constantes

#  - platform: xiaomi_miio
#    name: Luz Nil
#    host: 192.168.1.13
#    token: !secret light_token  
    
  - platform: limitlessled  # Leds
    bridges:
      - host: 192.168.1.210
#        version: 6
#        version: 4 5 6 SI
#        port: 8899
        groups:
        - number: 1
          name: Mueble
          type: rgbww
        - number: 2
          name: Cortina
          type: rgbww
        - number: 3
          name: Ventana
          type: rgbww

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml
